name: ๐ง ะขะตัั SSH ะฟะพะดะบะปััะตะฝะธั

on:
  workflow_dispatch:  # ะขะพะปัะบะพ ัััะฝะพะน ะทะฐะฟััะบ

jobs:
  test-ssh:
    runs-on: ubuntu-latest
    
    steps:
    - name: ๐ ะะฐัััะพะธัั SSH
      uses: webfactory/ssh-agent@v0.5.4
      with:
        ssh-private-key: ${{ secrets.SSH_PRIVATE_KEY }}
    
    - name: ๐ ะะพะฑะฐะฒะธัั ัะตัะฒะตั ะฒ known_hosts
      run: |
        mkdir -p ~/.ssh
        ssh-keyscan -H 10.7.0.30 >> ~/.ssh/known_hosts
        echo "โ ะกะตัะฒะตั ะดะพะฑะฐะฒะปะตะฝ ะฒ known_hosts"
    
    - name: ๐ ะัะพะฒะตัะธัั ะฟะพะดะบะปััะตะฝะธะต
      run: |
        echo "๐ ะัะพะฒะตััะตะผ SSH ะฟะพะดะบะปััะตะฝะธะต..."
        ssh -o ConnectTimeout=5 admin1@10.7.0.30 "echo 'โ SSH ะฟะพะดะบะปััะตะฝะธะต ััะฟะตัะฝะพ!'" || echo "โ ะะต ัะดะฐะปะพัั ะฟะพะดะบะปััะธัััั"
    
    - name: ๐ ะัะพะฒะตัะธัั ะฟะฐะฟะบั ะฝะฐ ัะตัะฒะตัะต
      run: |
        echo "๐ ะัะพะฒะตััะตะผ ัััะตััะฒะพะฒะฐะฝะธะต ะฟะฐะฟะบะธ..."
        ssh admin1@10.7.0.30 "
          echo '๐ค ะะพะปัะทะพะฒะฐัะตะปั: $(whoami)'
          echo '๐ ะะพะผะฐัะฝัั ะฟะฐะฟะบะฐ: $(pwd)'
          echo '๐ ะกะพะดะตัะถะธะผะพะต /home/admin1/warehouse/:'
          ls -la /home/admin1/warehouse/ || echo 'ะะฐะฟะบะฐ ะฝะต ัััะตััะฒัะตั'
        "
